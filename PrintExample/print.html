
<!DOCTYPE html>
<script src="bxlcommon.js"></script>
<script src="bxlpos.js"></script>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible">
	<title>Print Ticket</title>
</head>

<script type="text/javascript">


	function viewResult(result) {
		//p_result.value = result;
		if(result!= "")alert(result);
	}

	function SendTicket(){
		let date = new Date;
		PrintTicket(date,date,30500,2.5,300,"code url 0123181385418");
	}

	function PrintTicket(fec1,fec2,BTC,USD,SAT,QRurl) {

		//Datos
		
		let printName = "Printer1";
		setPosId(1);
		checkPrinterStatus();
		setConnectionMode("wss:");

		USD = Number(USD).toFixed(2); 
		let nf = new Intl.NumberFormat('en-US');
        BTC = nf.format(BTC);

		printText("\n\nBitChange\nEl Salvador Cubo+\nName Company\n\n", 0, 0, true, false, false, 0, 1);
		
		printQRCode("www.bitchange.site",0,1,7,0);
		printText("\nwww.bitchange.site", 0, 0, true, false, false, 0, 1);
		printText("\nTel : +503 7000-0000\n\n", 0, 0, true, false, false, 0, 0);
		
		printText("------------------------------------------\n", 0, 0, false, false, false, 0, 0);
		printText("Datos de Conversion - Data Convertion\n"     , 0, 0, true , false, false, 0, 1);
		printText("                                          \n", 0, 0, false, false, false, 0, 0);
		printText("BTC to USD:                "+BTC+"        \n", 0, 0, false, false, false, 0, 0);
		printText("UTC Date:                                \n", 0, 0, true , false, false, 0, 0);
		printText(fec2.toUTCString("ddMMyyyyHHmmss")+       "\n", 0, 0, false, false, false, 0, 0);		
		printText("Local Date:                              \n", 0, 0, true , false, false, 0, 0);
		printText(fec1.toString("ddMMyyyyHHmmss")+          "\n", 0, 0, false, false, false, 0, 0);		
		printText("------------------------------------------\n", 0, 0, false, false, false, 0, 0);
		printText("Monto Vuelto - Change Amount\n"                              , 0, 0, true , false, false, 0, 1);
		printText("                                          \n", 0, 0, false, false, false, 0, 0);
		printText("USD:                       "+USD+"        \n", 0, 0, false, false, false, 0, 0);
		printText("Satoshi:                 "+SAT+"          \n", 0, 0, false, false, false, 0, 0);
		printText("------------------------------------------\n", 0, 0, false, false, false, 0, 0);
		
		printText("\n\n", 0, 0, false, false, false, 0, 0);
		printText("Cambio - Change\n\n", 0, 0, true, false, false, 0, 1);
		printQRCode(QRurl,0,1,7,0);
		printText("\n\n\n\n\n", 0, 0, false, false, false, 0, 0);
		cutPaper(1);

		var strSubmit = getPosData();

		console.log(strSubmit);
		requestPrint(printName, strSubmit, viewResult);

		return true;
	}

</script>
<body>
	<header>
	</header>

	<section>

		<div id="contain">
			<div>
				<button onclick="SendTicket();">Print Ticket</button>
			</div>
		</div>
	</section>

	</body>

</html>
